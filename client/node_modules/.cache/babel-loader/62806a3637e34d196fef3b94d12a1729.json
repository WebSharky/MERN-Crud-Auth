{"ast":null,"code":"import { createSlice, nanoid, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport axios from 'axios'; // const POSTS_URL = 'https://jsonplaceholder.typicode.com/posts'\n\nconst POSTS_URL = 'http://localhost:5000/posts/';\nconst initialState = {\n  posts: [],\n  status: 'idle',\n  error: null,\n  createPostStatus: 'idle'\n};\nexport const fetchPosts = createAsyncThunk('posts/fetchPosts', async () => {\n  try {\n    const response = await axios.get(POSTS_URL);\n    return response.data;\n  } catch (error) {\n    return error.message;\n  }\n});\nexport const addNewPost = createAsyncThunk('posts/addNewPost', async postToSubmit => {\n  console.log('post to submit', postToSubmit);\n\n  try {\n    const request = await axios.post(POSTS_URL, postToSubmit);\n    request = { ...request\n    } + { ...postToSubmit\n    };\n    return request.data;\n  } catch (error) {\n    return error.message;\n  }\n});\nconst postsSlice = createSlice({\n  name: 'posts',\n  initialState,\n  reducers: {\n    postAdded: {\n      reducer(state, action) {\n        state.push(action.payload);\n      },\n\n      prepare(title, body, author) {\n        return {\n          payload: {\n            id: nanoid(),\n            title,\n            body,\n            author,\n            createdAt: new Date().toISOString(),\n            gowno: \"gowno\"\n          }\n        };\n      }\n\n    }\n  },\n\n  extraReducers(builder) {\n    builder.addCase(fetchPosts.pending, (state, action) => {\n      state.status = 'loading';\n    }).addCase(fetchPosts.fulfilled, (state, action) => {\n      state.status = 'succeeded';\n      const loadedPosts = action.payload.map(post => {\n        post.myMessage = `to moja wiadomość z ${new Date()}`;\n        return post;\n      });\n      state.posts = state.posts.concat(loadedPosts);\n    }).addCase(fetchPosts.rejected, (state, action) => {\n      state.status = 'failed';\n      state.error = action.error.message;\n    }).addCase(addNewPost.pending, (state, action) => {\n      state.createPostStatus = 'loading';\n    }).addCase(addNewPost.fulfilled, (state, action) => {\n      state.createPostStatus = 'succeed';\n      state.posts.push(action.payload);\n    }).addCase(addNewPost.rejected, (state, action) => {\n      state.createPostStatus = 'failed';\n      state.error = action.error.message;\n    });\n  }\n\n});\nexport const selectAllPosts = state => state.posts.posts;\nexport const getPostsStatus = state => state.posts.status;\nexport const getPostsError = state => state.posts.error;\nexport const {\n  postAdded\n} = postsSlice.actions;\nexport default postsSlice.reducer;","map":{"version":3,"names":["createSlice","nanoid","createAsyncThunk","axios","POSTS_URL","initialState","posts","status","error","createPostStatus","fetchPosts","response","get","data","message","addNewPost","postToSubmit","console","log","request","post","postsSlice","name","reducers","postAdded","reducer","state","action","push","payload","prepare","title","body","author","id","createdAt","Date","toISOString","gowno","extraReducers","builder","addCase","pending","fulfilled","loadedPosts","map","myMessage","concat","rejected","selectAllPosts","getPostsStatus","getPostsError","actions"],"sources":["F:/PROJEKTY WWW/NEW_MERN_092022/client/src/features/posts/postsSlice.js"],"sourcesContent":["import { createSlice, nanoid, createAsyncThunk} from \"@reduxjs/toolkit\";\r\nimport axios from 'axios'\r\n// const POSTS_URL = 'https://jsonplaceholder.typicode.com/posts'\r\nconst POSTS_URL = 'http://localhost:5000/posts/'\r\n\r\nconst initialState = {\r\n   posts: [],\r\n   status: 'idle',\r\n   error: null,\r\n   createPostStatus: 'idle'\r\n}\r\n\r\nexport const fetchPosts = createAsyncThunk('posts/fetchPosts', async () => {\r\n    try {\r\n        const response = await axios.get(POSTS_URL)\r\n        return response.data\r\n    } catch (error) {\r\n        return error.message\r\n    }\r\n})\r\n\r\nexport const addNewPost = createAsyncThunk('posts/addNewPost', async (postToSubmit) => {\r\n    console.log('post to submit',postToSubmit)\r\n    try {\r\n        \r\n        const request = await axios.post(POSTS_URL, postToSubmit)\r\n        request = {...request } + {... postToSubmit} \r\n        \r\n        return request.data\r\n        \r\n    } catch (error) {\r\n        return error.message\r\n    }\r\n})\r\n\r\n\r\n\r\nconst postsSlice = createSlice({\r\n    name: 'posts',\r\n    initialState,\r\n    reducers: {\r\n        postAdded: {\r\n            reducer(state, action) {\r\n                state.push(action.payload)\r\n                },\r\n            prepare(title, body, author) {\r\n                return {\r\n                    payload: {\r\n                    id: nanoid(),\r\n                    title,\r\n                    body,\r\n                    author,\r\n                    createdAt: new Date().toISOString(),\r\n                    gowno: \"gowno\"                  \r\n                }\r\n                }\r\n            }\r\n        },\r\n    },\r\n    extraReducers(builder) {\r\n        builder\r\n            .addCase(fetchPosts.pending, (state, action) => {\r\n                state.status = 'loading'\r\n            })\r\n            .addCase(fetchPosts.fulfilled, (state, action) => {\r\n                state.status = 'succeeded'\r\n                const loadedPosts = action.payload.map(post => {\r\n                    post.myMessage = `to moja wiadomość z ${new Date()}`\r\n                    return post\r\n                })\r\n                state.posts = state.posts.concat(loadedPosts)\r\n            })\r\n            .addCase(fetchPosts.rejected, (state, action) => {\r\n                state.status = 'failed'\r\n                state.error = action.error.message\r\n            })\r\n            .addCase(addNewPost.pending, (state, action) => {\r\n                state.createPostStatus = 'loading'\r\n                \r\n            })\r\n            .addCase(addNewPost.fulfilled, (state, action) => {\r\n                state.createPostStatus = 'succeed'\r\n                state.posts.push(action.payload)\r\n            })\r\n            .addCase(addNewPost.rejected, (state, action) => {\r\n                state.createPostStatus = 'failed'\r\n                state.error = action.error.message\r\n            })\r\n\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n})\r\n\r\nexport const selectAllPosts = (state) => state.posts.posts\r\nexport const getPostsStatus = (state) => state.posts.status\r\nexport const getPostsError = (state) => state.posts.error\r\n\r\nexport const {postAdded} = postsSlice.actions\r\n\r\nexport default postsSlice.reducer"],"mappings":"AAAA,SAASA,WAAT,EAAsBC,MAAtB,EAA8BC,gBAA9B,QAAqD,kBAArD;AACA,OAAOC,KAAP,MAAkB,OAAlB,C,CACA;;AACA,MAAMC,SAAS,GAAG,8BAAlB;AAEA,MAAMC,YAAY,GAAG;EAClBC,KAAK,EAAE,EADW;EAElBC,MAAM,EAAE,MAFU;EAGlBC,KAAK,EAAE,IAHW;EAIlBC,gBAAgB,EAAE;AAJA,CAArB;AAOA,OAAO,MAAMC,UAAU,GAAGR,gBAAgB,CAAC,kBAAD,EAAqB,YAAY;EACvE,IAAI;IACA,MAAMS,QAAQ,GAAG,MAAMR,KAAK,CAACS,GAAN,CAAUR,SAAV,CAAvB;IACA,OAAOO,QAAQ,CAACE,IAAhB;EACH,CAHD,CAGE,OAAOL,KAAP,EAAc;IACZ,OAAOA,KAAK,CAACM,OAAb;EACH;AACJ,CAPyC,CAAnC;AASP,OAAO,MAAMC,UAAU,GAAGb,gBAAgB,CAAC,kBAAD,EAAqB,MAAOc,YAAP,IAAwB;EACnFC,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA6BF,YAA7B;;EACA,IAAI;IAEA,MAAMG,OAAO,GAAG,MAAMhB,KAAK,CAACiB,IAAN,CAAWhB,SAAX,EAAsBY,YAAtB,CAAtB;IACAG,OAAO,GAAG,EAAC,GAAGA;IAAJ,IAAgB,EAAC,GAAIH;IAAL,CAA1B;IAEA,OAAOG,OAAO,CAACN,IAAf;EAEH,CAPD,CAOE,OAAOL,KAAP,EAAc;IACZ,OAAOA,KAAK,CAACM,OAAb;EACH;AACJ,CAZyC,CAAnC;AAgBP,MAAMO,UAAU,GAAGrB,WAAW,CAAC;EAC3BsB,IAAI,EAAE,OADqB;EAE3BjB,YAF2B;EAG3BkB,QAAQ,EAAE;IACNC,SAAS,EAAE;MACPC,OAAO,CAACC,KAAD,EAAQC,MAAR,EAAgB;QACnBD,KAAK,CAACE,IAAN,CAAWD,MAAM,CAACE,OAAlB;MACC,CAHE;;MAIPC,OAAO,CAACC,KAAD,EAAQC,IAAR,EAAcC,MAAd,EAAsB;QACzB,OAAO;UACHJ,OAAO,EAAE;YACTK,EAAE,EAAEjC,MAAM,EADD;YAET8B,KAFS;YAGTC,IAHS;YAITC,MAJS;YAKTE,SAAS,EAAE,IAAIC,IAAJ,GAAWC,WAAX,EALF;YAMTC,KAAK,EAAE;UANE;QADN,CAAP;MAUH;;IAfM;EADL,CAHiB;;EAsB3BC,aAAa,CAACC,OAAD,EAAU;IACnBA,OAAO,CACFC,OADL,CACa/B,UAAU,CAACgC,OADxB,EACiC,CAAChB,KAAD,EAAQC,MAAR,KAAmB;MAC5CD,KAAK,CAACnB,MAAN,GAAe,SAAf;IACH,CAHL,EAIKkC,OAJL,CAIa/B,UAAU,CAACiC,SAJxB,EAImC,CAACjB,KAAD,EAAQC,MAAR,KAAmB;MAC9CD,KAAK,CAACnB,MAAN,GAAe,WAAf;MACA,MAAMqC,WAAW,GAAGjB,MAAM,CAACE,OAAP,CAAegB,GAAf,CAAmBzB,IAAI,IAAI;QAC3CA,IAAI,CAAC0B,SAAL,GAAkB,uBAAsB,IAAIV,IAAJ,EAAW,EAAnD;QACA,OAAOhB,IAAP;MACH,CAHmB,CAApB;MAIAM,KAAK,CAACpB,KAAN,GAAcoB,KAAK,CAACpB,KAAN,CAAYyC,MAAZ,CAAmBH,WAAnB,CAAd;IACH,CAXL,EAYKH,OAZL,CAYa/B,UAAU,CAACsC,QAZxB,EAYkC,CAACtB,KAAD,EAAQC,MAAR,KAAmB;MAC7CD,KAAK,CAACnB,MAAN,GAAe,QAAf;MACAmB,KAAK,CAAClB,KAAN,GAAcmB,MAAM,CAACnB,KAAP,CAAaM,OAA3B;IACH,CAfL,EAgBK2B,OAhBL,CAgBa1B,UAAU,CAAC2B,OAhBxB,EAgBiC,CAAChB,KAAD,EAAQC,MAAR,KAAmB;MAC5CD,KAAK,CAACjB,gBAAN,GAAyB,SAAzB;IAEH,CAnBL,EAoBKgC,OApBL,CAoBa1B,UAAU,CAAC4B,SApBxB,EAoBmC,CAACjB,KAAD,EAAQC,MAAR,KAAmB;MAC9CD,KAAK,CAACjB,gBAAN,GAAyB,SAAzB;MACAiB,KAAK,CAACpB,KAAN,CAAYsB,IAAZ,CAAiBD,MAAM,CAACE,OAAxB;IACH,CAvBL,EAwBKY,OAxBL,CAwBa1B,UAAU,CAACiC,QAxBxB,EAwBkC,CAACtB,KAAD,EAAQC,MAAR,KAAmB;MAC7CD,KAAK,CAACjB,gBAAN,GAAyB,QAAzB;MACAiB,KAAK,CAAClB,KAAN,GAAcmB,MAAM,CAACnB,KAAP,CAAaM,OAA3B;IACH,CA3BL;EAkCH;;AAzD0B,CAAD,CAA9B;AA4DA,OAAO,MAAMmC,cAAc,GAAIvB,KAAD,IAAWA,KAAK,CAACpB,KAAN,CAAYA,KAA9C;AACP,OAAO,MAAM4C,cAAc,GAAIxB,KAAD,IAAWA,KAAK,CAACpB,KAAN,CAAYC,MAA9C;AACP,OAAO,MAAM4C,aAAa,GAAIzB,KAAD,IAAWA,KAAK,CAACpB,KAAN,CAAYE,KAA7C;AAEP,OAAO,MAAM;EAACgB;AAAD,IAAcH,UAAU,CAAC+B,OAA/B;AAEP,eAAe/B,UAAU,CAACI,OAA1B"},"metadata":{},"sourceType":"module"}